<div class="page-with-navbar">
  <div class="page-with-navbar__header">
    <div class="container">
      <div class="container">
        <img
          src="/assets/back_arrow.svg"
          alt="Retour"
          class="back-arrow"
          (click)="goBack()"
        />
        <h1 class="page-title">Créer un nouvel article</h1>
      </div>
    </div>
  </div>

  <div class="page-with-navbar__content">
    <div class="container">
      <div class="create-form">
        <form [formGroup]="articleForm" (ngSubmit)="onSubmit()">
          <!-- Thème - CORRECTION: themeId → subjectId -->
          <div class="form__group">
            <select
              class="form__field"
              [class.form__field--error]="hasError('subjectId')"
              formControlName="subjectId"
            >
              <option value="">Sélectionnez un thème</option>
              <option *ngFor="let theme of themes" [value]="theme.id">
                {{ theme.name }}
              </option>
            </select>
            <div class="form__error" *ngIf="hasError('subjectId')">
              <span>Le sujet est obligatoire.</span>
            </div>
          </div>

          <!-- Titre de l'article -->
          <div class="form__group">
            <input
              class="form__field"
              [class.form__field--error]="hasError('title')"
              formControlName="title"
              placeholder="Titre de l'article"
              type="text"
            />
            <div class="form__error" *ngIf="hasError('title')">
              <span *ngIf="articleForm.get('title')?.errors?.['required']">
                Le titre est obligatoire.
              </span>
              <span *ngIf="articleForm.get('title')?.errors?.['minlength']">
                Le titre doit contenir au moins 5 caractères.
              </span>
              <span *ngIf="articleForm.get('title')?.errors?.['maxlength']">
                Le titre ne peut pas dépasser 200 caractères.
              </span>
            </div>
          </div>

          <!-- Contenu de l'article -->
          <div class="form__group">
            <textarea
              class="form__field"
              [class.form__field--error]="hasError('content')"
              formControlName="content"
              placeholder="Contenu de l'article"
              rows="8"
            ></textarea>
            <div class="form__error" *ngIf="hasError('content')">
              <span *ngIf="articleForm.get('content')?.errors?.['required']">
                Le contenu est obligatoire.
              </span>
              <span *ngIf="articleForm.get('content')?.errors?.['minlength']">
                Le contenu doit contenir au moins 10 caractères.
              </span>
              <span *ngIf="articleForm.get('content')?.errors?.['maxlength']">
                Le contenu ne peut pas dépasser 2000 caractères.
              </span>
            </div>
          </div>

          <!-- Bouton Créer -->
          <div class="form__group">
            <button
              class="btn btn--primary"
              type="submit"
              [disabled]="!articleForm.valid || isSubmitting"
            >
              {{ isSubmitting ? "Création..." : "Créer" }}
            </button>
          </div>
        </form>
      </div>
    </div>